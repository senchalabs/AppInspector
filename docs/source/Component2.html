<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='AI-util-Component'>/**
</span> * Utility class containing methods which run in the context of the inspectedWindow
 */
Ext.define('AI.util.Component', {
    singleton : true,

<span id='AI-util-Component-method-loadComponentTree'>    /**
</span>     * @returns {*}
     */
    loadComponentTree : function () {
        var getComponentTreeNodes = function (comps) {
            var compNodes = [];

            var getCompNodeForComp = function (comp) {
                return {
                    text     : comp.id + (comp.itemId ? ' (' + comp.itemId + ')' : ''),
                    cmpId    : comp.id || '',
                    itemId   : comp.itemId || '',
                    xtype    : comp.xtype,
                    children : []
                };
            };

            if (!comps) {
                return;
            }

            if (!Ext.isArray(comps)) {
                comps = [comps];
            }

            Ext.each(comps, function (comp) {
                var node = getCompNodeForComp(comp),
                    items = {
                        text     : 'items',
                        children : []
                    },
                    dockedItems = {
                        text     : 'dockedItems',
                        children : []
                    },
                    children;

                if (comp.items &amp;&amp; comp.items.items &amp;&amp; comp.items.items.length) {
                    children = getComponentTreeNodes(comp.items.items); //recursion...

                    Ext.each(children, function (child) {
                        items.children.push(child);
                    });

                    node.children.push(items);
                }

                if (comp.dockedItems &amp;&amp; comp.dockedItems.items &amp;&amp; comp.dockedItems.items.length) {
                    children = getComponentTreeNodes(comp.dockedItems.items); //recursion...

                    Ext.each(children, function (child) {
                        dockedItems.children.push(child);
                    });

                    node.children.push(dockedItems);
                }

                compNodes.push(node);
            });

            return compNodes;
        };

        //GET TOP LEVEL COMPONENTS FIRST
        var top = [],
            all = Ext.ComponentManager.all.getArray(),
            nodes;

        Ext.each(all, function (comp) {
            if (!comp.ownerCt &amp;&amp; !comp.parent) {
                top.push(comp);
            }
        });

        nodes = getComponentTreeNodes(top);

        return nodes;
    },

<span id='AI-util-Component-method-getInspectedComponent'>    /**
</span>     * @returns {Object/undefined}
     */
    getInspectedComponent : function (id) {
        var cmp, data, key;

        cmp = Ext.getCmp(id);

        if (cmp) {
            data = Object.create(null); //which sets __proto__ to undefined
            data.properties = Object.create(null);
            data.methods = Object.create(null);

            for (key in cmp) {
                if (typeof cmp[key] === 'function') {
                    data.methods[key] = 'METHOD';
                }
                else if (typeof cmp[key] !== 'object') {
                    data.properties[key] = cmp[key];
                }
            }
        }

        return data;
    }
});</pre>
</body>
</html>
