Ext.data.JsonP.testing_sencha_touch_app({"guide":"<h2 id='testing_sencha_touch_app-section-intro'>Intro</h2>\n<div class='toc'>\n<p><strong>Contents</strong></p>\n<ol>\n<li><a href='#!/guide/testing_sencha_touch_app-section-intro'>Intro</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-a-sample-application'>A sample application</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-testing-objectives'>Testing objectives</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-1.-the-%22sanity%22-test'>1. The \"sanity\" test</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-2.-the-%22login%22-test'>2. The \"login\" test</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-3.-the-%22logout%22-test'>3. The \"logout\" test</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-final-refactoring'>Final Refactoring</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-automatic-login'>Automatic login</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-testing-extjs-application'>Testing ExtJS application</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-conclusion'>Conclusion</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-buy-this-product'>Buy this product</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-support'>Support</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-see-also'>See also</a></li>\n<li><a href='#!/guide/testing_sencha_touch_app-section-copyright-and-license'>COPYRIGHT AND LICENSE</a></li>\n</ol>\n</div>\n\n<p>In this guide, we show you how to write application level tests with Siesta. Note, that application\ntests are very different from unit tests, where you typically take one class and focus on testing its API.\nFor an application test, we typically just point Siesta to a <a href=\"#!/api/Siesta.Harness.Browser-cfg-hostPageUrl\" rel=\"Siesta.Harness.Browser-cfg-hostPageUrl\" class=\"docClass\">Siesta.Harness.Browser.hostPageUrl</a> and perform actions\non the page.</p>\n\n<h2 id='testing_sencha_touch_app-section-a-sample-application'>A sample application</h2>\n\n<p>The sample used in this guide can also be found in the Siesta examples folder: <code>/examples-touch/DemoApp</code>.\nThe harness html file is called <code>tests.html</code> and javascript part of harness is called <code>tests.js</code>.\nNote, that <code>tests.html</code> is purposefully placed near the <code>index.html</code> file which is an entry point to the application.\nIn this way, the relative paths to externals files in the tests will be the same as in application.</p>\n\n<p>The sample is based on one of the samples in the Sencha Touch SDK examples folder. To make it more application like,\nwe added a login screen since this is a very common use case in apps built with Sencha Touch.\nOverall, the demo application is very simple and features these screens:</p>\n\n<p><img style=\"float:left;width:20%;margin-right:1%\" src=\"http://www.bryntum.com/wp-content/uploads/2013/02/Screen-Shot-2013-02-13-at-5.46.03-PM.png\" alt=\"Screen Shot 2013-02-13 at 5.46.03 PM\" width=\"200\" class=\"alignnone size-thumbnail wp-image-2595\" />\n<img style=\"float:left;width:20%;margin-right:1%\" src=\"http://www.bryntum.com/wp-content/uploads/2013/02/Screen-Shot-2013-02-13-at-5.47.15-PM.png\" alt=\"Screen Shot 2013-02-13 at 5.47.15 PM\" width=\"200\" class=\"alignnone size-thumbnail wp-image-2596\" />\n<img style=\"float:left;width:20%;\" src=\"http://www.bryntum.com/wp-content/uploads/2013/02/Screen-Shot-2013-02-13-at-5.47.25-PM.png\" alt=\"Screen Shot 2013-02-13 at 5.47.25 PM\" width=\"200\" class=\"alignnone size-thumbnail wp-image-2597\" /></p>\n\n<div style=\"clear:both\"></div>\n\n\n<p><br></p>\n\n<p>First, a user should login and after logging in, an address list is shown. You can then click a contact in the list\nand see his or her details.</p>\n\n<h2 id='testing_sencha_touch_app-section-testing-objectives'>Testing objectives</h2>\n\n<p>To perform a basic smoke test of this application, let's write three basic application tests.</p>\n\n<ol>\n<li>A sanity test to assert that upon visiting the app page, the login screen is shown</li>\n<li>A basic login test, which navigates to one of the contacts in the list.</li>\n<li>A basic logout test which makes sure we can log out ok.</li>\n</ol>\n\n\n<p>The Harness code can be seen below:</p>\n\n<pre><code>var Harness = <a href=\"#!/api/Siesta.Harness.Browser.SenchaTouch\" rel=\"Siesta.Harness.Browser.SenchaTouch\" class=\"docClass\">Siesta.Harness.Browser.SenchaTouch</a>;\n\nHarness.configure({\n    title       : 'Sencha Touch 2 samples',\n    testClass   : Your.Test.Class\n});\n\nHarness.start(\n    {\n        group         : 'Application tests',\n        hostPageUrl   : 'DemoApp/',\n        performSetup  : false,       // This is done by the app itself\n        items         : [\n             'tests/100_sanity.t.js',\n             'tests/101_login.t.js',\n             'tests/102_logout.t.js'\n        ]\n    }\n);\n// eof Harness.start\n</code></pre>\n\n<h2 id='testing_sencha_touch_app-section-1.-the-%22sanity%22-test'>1. The \"sanity\" test</h2>\n\n<p>A sanity test is a simple way of knowing the health of the test subject. For a typical application,\nthat might mean to load up the start page and assure that the login window appears. No exceptions\nshould be thrown, no errors should be found and no global variables leaked etc.\nHere's the Siesta test code for the 'sanity' test.</p>\n\n<pre><code>StartTest(function(t) {\n\n    t.chain(\n        { \n            waitFor : 'CQ', \n            args    : 'loginview',\n            desc    : 'Should find login view on app start'\n        },\n\n        function(next) {\n            t.ok(t.cq1('#logInButton'), 'Should find a login button');\n        }\n    );\n});\n</code></pre>\n\n<p>The test waits for a known <a href=\"http://docs.sencha.com/extjs/#!/api/Ext.ComponentQuery\">Ext.ComponentQuery</a>, the 'loginview' xtype.\nOnce it's detected, we consider it a green light and just check that the login button is also created.\nThis is very simplistic, but still tells us that the landing page is healthy and no silly errors has leaked on it.</p>\n\n<h2 id='testing_sencha_touch_app-section-2.-the-%22login%22-test'>2. The \"login\" test</h2>\n\n<p>This test starts by waiting for the login button to be visible. Since we want to tap\nthe button, it's not enough just to wait for it to exist - it also has to be visible so we can 'reach' it\n(during rendering, components are often rendered off-screen).\nAfter this step, we simply set some values in the login fields. We're not simulating typing,\nsince there is no reason to test this - it's a lot faster and more robust to just use the public Field API.\nAfter logging in, we wait for a <a href=\"#!/api/Siesta.Test.ExtJSCore-method-compositeQuery\" rel=\"Siesta.Test.ExtJSCore-method-compositeQuery\" class=\"docClass\">compositeQuery</a> - a component query combined with a CSS query.\nOnce we find a contact item in the DOM, we tap it to show the contact details.</p>\n\n<pre><code>StartTest(function(t) {\n\n    t.chain(\n        { waitFor : 'componentVisible', args : '#logInButton' },\n\n        function(next) {\n            t.cq1('#userNameField').setValue('John Doe');\n            t.cq1('#passwordField').setValue('SecretUnhackablePW');\n            next();\n        },\n\n        { tap : '&gt;&gt; #logInButton' },\n\n        // We'd like to find a headshot icon the DOM, that's proof the main app has been launched ok\n        { \n            waitFor : 'compositeQuery', \n            args    : 'contacts =&gt; .headshot',\n            desc    : 'Should be able login and see contact list'\n        },\n\n        { tap : 'contacts =&gt; .headshot' },\n\n        { waitFor : 'componentVisible', args : 'map' },\n\n        function(next) {\n            t.pass('Should see a detail view with map after tapping a contact');\n        }\n    );\n});\n</code></pre>\n\n<h2 id='testing_sencha_touch_app-section-3.-the-%22logout%22-test'>3. The \"logout\" test</h2>\n\n<p>This logout test just logs in, and immediately logs out again. This should take the user back to the login dialog, and this is exactly what's being assured in the test code below.</p>\n\n<pre><code>StartTest(function(t) {\n\n     t.chain(\n         { waitFor : 'componentVisible', args : '#logInButton' },\n\n         function(next) {\n             t.cq1('#userNameField').setValue('John Doe');\n             t.cq1('#passwordField').setValue('SecretUnhackablePW');\n             next();\n         },\n\n         { tap : '&gt;&gt; #logInButton' },\n\n         // We'd like to find a headshot icon the DOM, that's proof the main app has been launched ok\n         { waitFor : 'compositeQuery', args : 'contacts =&gt; .headshot' },\n\n         function(next) {\n             t.willFireNTimes(App, 'logout', 1);\n             next();\n         },\n\n         { tap : '&gt;&gt;#logoutButton' },\n\n         { waitFor : 'componentVisible', args : 'loginview' },\n\n         function(next) {\n             t.pass('Should be able to log out and see login view');\n         }\n     );\n});\n</code></pre>\n\n<h2 id='testing_sencha_touch_app-section-final-refactoring'>Final Refactoring</h2>\n\n<p>As you can see in the logout test, we're duplicating the login process code. If we want to perform the login operation in many tests,\nit makes sense to break this behavior out and put it into a custom test class. See the <a href=\"#!/guide/extending_test_class\">\"Extending test class\"</a>\nguide for more details, here we'll just present the result:</p>\n\n<pre><code>Class('Your.Test.Class', {\n\n    isa     : <a href=\"#!/api/Siesta.Test.SenchaTouch\" rel=\"Siesta.Test.SenchaTouch\" class=\"docClass\">Siesta.Test.SenchaTouch</a>,\n\n    methods: {\n        login : function (user, pw, next) {\n            var me = this;\n\n            this.chain(\n                { waitFor : 'componentVisible', args : '#logInButton' },\n\n                function(next) {\n                    me.cq1('#userNameField').setValue(user);\n                    me.cq1('#passwordField').setValue(pw);\n                    next();\n                },\n\n                { action : 'tap', target : '&gt;&gt; #logInButton' },\n                { waitFor : 'compositeQuery', args : 'contacts =&gt; .headshot' },\n\n                next\n            );\n        }\n    }\n});\n</code></pre>\n\n<p>Note, that new <code>login</code> method is asynchronous - it accepts a callback, called <code>next</code>, which will be executed <em>after</em> login has completed.\nSample usage for the new method:</p>\n\n<pre><code>t.login('User', 'SecretPassword', function () {\n    // do something after login\n})\n\n// or, using \"chain\" method:\n\nt.chain(\n    ...\n    function (next) {\n        t.login('User', 'SecretPassword', next)\n    },\n    ...\n) \n</code></pre>\n\n<p>To plug this test class into your Siesta test suite, you need to simply load it on the harness page, right after \"siesta-all.js\" file:</p>\n\n<pre><code>    &lt;!-- Siesta application --&gt;\n    &lt;script type=\"text/javascript\" src=\"../../siesta-all.js\"&gt;&lt;/script&gt;\n\n    &lt;!-- Custom test class --&gt;\n    &lt;script type=\"text/javascript\" src=\"tests/lib/TestClass.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>Then, you configure the <a href=\"#!/api/Siesta.Harness-cfg-testClass\" rel=\"Siesta.Harness-cfg-testClass\" class=\"docClass\">testClass</a> property of the harness:</p>\n\n<pre><code>Harness.configure({\n    ...\n    testClass   : Your.Test.Class,\n    ...\n})\n</code></pre>\n\n<h2 id='testing_sencha_touch_app-section-automatic-login'>Automatic login</h2>\n\n<p>Sometimes its needed to perform an automatic login before every test, or before some group of tests. For that, you can use the <a href=\"#!/api/Siesta.Test-method-setup\" rel=\"Siesta.Test-method-setup\" class=\"docClass\">Siesta.Test.setup</a> method.\nFor example, if we should use the <code>login</code> method, created above, before every test with \"auto_login\" string in url, it may look as following:</p>\n\n<pre><code>Class('Your.Test.Class', {\n\n    isa     : <a href=\"#!/api/Siesta.Test.SenchaTouch\" rel=\"Siesta.Test.SenchaTouch\" class=\"docClass\">Siesta.Test.SenchaTouch</a>,\n\n    methods: {\n        login : function (user, pw, next) {\n            ...\n        },\n\n        setup : function (callback, errback) {\n            if (this.url.match(/auto_login/)) {\n                // call the `login` method for tests with \"auto_login\" string in url\n                // setup will wait until the login completes\n                this.login('TestUser', '12345', callback)\n            } else {\n                // call the `callback` immediately - setup will proceed to the test start\n                // right away\n                callback()\n            }\n        }\n    }\n});\n</code></pre>\n\n<h2 id='testing_sencha_touch_app-section-testing-extjs-application'>Testing ExtJS application</h2>\n\n<p>When testing ExtJS application, exactly the same principles applies. The only difference is that you need to use <a href=\"#!/api/Siesta.Harness.Browser.ExtJS\" rel=\"Siesta.Harness.Browser.ExtJS\" class=\"docClass\">Siesta.Harness.Browser.ExtJS</a> class for harness,\nand <a href=\"#!/api/Siesta.Test.ExtJS\" rel=\"Siesta.Test.ExtJS\" class=\"docClass\">Siesta.Test.ExtJS</a> as a base test class, when extending it.</p>\n\n<h2 id='testing_sencha_touch_app-section-conclusion'>Conclusion</h2>\n\n<p>We hope this gives you some inspiration on how to write application level tests for your Sencha Touch applications. Don't forget to write unit tests too :)</p>\n\n<h2 id='testing_sencha_touch_app-section-buy-this-product'>Buy this product</h2>\n\n<p>Visit our store: <a href=\"http://bryntum.com/store/siesta\">http://bryntum.com/store/siesta</a></p>\n\n<h2 id='testing_sencha_touch_app-section-support'>Support</h2>\n\n<p>Ask question in our community forum: <a href=\"http://www.bryntum.com/forum/viewforum.php?f=20\">http://www.bryntum.com/forum/viewforum.php?f=20</a></p>\n\n<p>Share your experience in our IRC channel: <a href=\"http://webchat.freenode.net/?randomnick=1&amp;channels=bryntum&amp;prompt=1\">#bryntum</a></p>\n\n<p>Please report any bugs through the web interface at <a href=\"https://www.assembla.com/spaces/bryntum/support/tickets\">https://www.assembla.com/spaces/bryntum/support/tickets</a></p>\n\n<h2 id='testing_sencha_touch_app-section-see-also'>See also</h2>\n\n<p>Web page of this product: <a href=\"http://bryntum.com/products/siesta\">http://bryntum.com/products/siesta</a></p>\n\n<p>Other Bryntum products: <a href=\"http://bryntum.com/products\">http://bryntum.com/products</a></p>\n\n<h2 id='testing_sencha_touch_app-section-copyright-and-license'>COPYRIGHT AND LICENSE</h2>\n\n<p>Copyright (c) 2009-2013, Bryntum &amp; Nickolay Platonov</p>\n\n<p>All rights reserved.</p>\n","title":"Testing a Sencha Touch application. Implementing automatic login before every test"});